#!/usr/bin/env perl -W

#
# mkerrno: generate a node module with errno constants from STDIN in the form
#     of /usr/include/sys/errno.h
#

use strict;

my $now = scalar(gmtime());

print <<"EOF";
/*
 * Generated by mkerrno at $now.  Do not edit.
 */

EOF

while (<>) {
	my $line = $_;

	if ($line =~ /^#define\s+(E\w+)\s+(\d+)/) {
		printf("exports.%s = %d;\n", $1, $2);
		next;
	}

	if ($line =~ /^#define\s+(E\w+)\s+(E\w+)/) {
		printf("exports.%s = exports.%s;\n", $1, $2);
		next;
	}
}
